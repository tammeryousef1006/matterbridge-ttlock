/**
 * @license
 * Copyright 2022-2025 Matter.js Authors
 * SPDX-License-Identifier: Apache-2.0
 */
import { EndpointInitializer } from "#endpoint/index.js";
import { ServerNodeStore } from "#node/storage/ServerNodeStore.js";
import { FabricManager, SessionManager } from "#protocol";
import { ServerEndpointInitializer } from "../../endpoint/server/ServerEndpointInitializer.js";
import { IdentityService } from "./IdentityService.js";
var ServerEnvironment;
((ServerEnvironment2) => {
  async function initialize(node) {
    const { env } = node;
    env.set(ServerNodeStore, await ServerNodeStore.create(env, node.id));
    env.set(EndpointInitializer, new ServerEndpointInitializer(env));
    env.set(IdentityService, new IdentityService(node));
    await env.load(FabricManager);
    await env.load(SessionManager);
  }
  ServerEnvironment2.initialize = initialize;
  async function close(node) {
    const { env } = node;
    env.close(FabricManager);
    await env.close(SessionManager);
    await env.close(ServerNodeStore);
  }
  ServerEnvironment2.close = close;
})(ServerEnvironment || (ServerEnvironment = {}));
export {
  ServerEnvironment
};
//# sourceMappingURL=ServerEnvironment.js.map
